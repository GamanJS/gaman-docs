---

title: Websocket

description: adalah modul GamanJS untuk membuat dan mengelola koneksi WebSocket dengan mudah.

---

`@gaman/websocket` is the official plugin dedicated to GamanJS. This plugin is built on top of the [`ws`](https://github.com/websockets/ws) library.

## install

import { PackageManagers } from "starlight-package-managers";

GamanJS is a framework for backend applications, you can install using your favorite package manager:

<PackageManagers

  pkg="@gaman/websocket ws"

  pkgManagers={["npm", "pnpm", "yarn", "bun"]}

  type="install"

 />

:::note

If you are using TypeScript, it is recommended to install the type definitions as well:

 ```bash
 npm install --save-dev @types/ws
 ```

:::

## Usage

Upgrade your HTTP server with `@gaman/websocket` here's how:

 ```ts
 // index.ts
 import { WebsocketGateway } from "@gaman/websocket"

 defineBootstrap(async (app) => {
   const server = await app.mountServer(':3431').
   WebsocketGateway.upgrade(server); // upgrade your http
 });
 ```

### Websocket Handler

Now create your websocket handler using `composeWebsocket()`

 ```ts
 // ChatWebsocket.ts
 import { composeWebsocket } from "@gaman/websocket"

 export default composeWebsocket((event) => {
   Log.info('Client joined: ' + event.clientId);
   event.onMessage((msg) => {
     event.send('your message: ' + msg);
   })
 })
 ```

### Add to Route

Now add the `ChatWebsocket.ts` to the route you want

 ```ts
 // AppRoutes.ts
 import { ChatWebsocket } from ".";

 export default autoComposeRoutes((route) => {
   route.ws('/chat', ChatWebsocket);
 });
 ```

Then connect to `ws://localhost:3431/chat`

If you are using `wscat`, use this command `wscat -c ws://localhost:3431/chat` then type a message and enter

### Client Side

Here is an example of accessing GamanJS websocket from the client side

 ```html
 <script>
   const socket = new WebSocket('ws://localhost:3431/chat')
   socket.onmessage = (event) => {
     console.log(event.data) // output: 'Client joined: 21515151-client-id'
   }
 </script>
 ```